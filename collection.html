<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Collection | Lotex Opticals</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=Playfair+Display:ital,wght@0,700;1,700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* Collection Specific Styles */
        .page-header {
            padding: 12rem 0 4rem;
            background-color: var(--bg-accent);
            text-align: center;
        }

        /* Layout */
        .collection-layout {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 3rem;
            margin-top: 4rem;
        }

        /* Sidebar Filters */
        .filter-sidebar {
            background: white;
            border-right: 1px solid #f0f0f0;
            padding-right: 2rem;
            height: fit-content;
        }

        .filter-group {
            border-bottom: 1px solid #f0f0f0;
            padding: 1.5rem 0;
        }

        .filter-group:first-child {
            padding-top: 0;
        }

        .filter-title {
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }

        .filter-options {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }

        .filter-checkbox {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-size: 0.9rem;
            color: var(--text-muted);
            cursor: pointer;
            transition: var(--transition);
        }

        .filter-checkbox:hover {
            color: var(--primary-dark);
        }

        .filter-checkbox input {
            accent-color: var(--primary);
            width: 16px;
            height: 16px;
        }

        .price-range-inputs {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .price-input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: var(--font-body);
        }

        /* Mobile Filter Toggle */
        .mobile-filter-toggle {
            display: none;
            background: var(--text-main);
            color: white;
            padding: 1rem 2rem;
            border-radius: 50px;
            width: 100%;
            text-align: center;
            margin-bottom: 2rem;
            cursor: pointer;
            font-weight: 700;
            z-index: 10;
            position: relative;
        }

        /* Products Grid */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 2rem;
            margin-bottom: 6rem;
        }

        .product-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            transition: var(--transition);
            border: 1px solid rgba(0, 0, 0, 0.04);
            /* Subtler border */
            position: relative;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.02);
            /* Soft initial shadow */
        }

        .product-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.08);
            border-color: rgba(0, 255, 170, 0.2);
            /* Subtle green hint on hover */
        }

        .product-image-wrapper {
            overflow: hidden;
            position: relative;
            background: #ffffff;
            /* Clean white background like reference */
            width: 100%;
            aspect-ratio: 4/3;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1;
        }

        /* Floor Shadow Effect */
        .product-image-wrapper::after {
            display: none;
        }



        /* Product Image & Hover Effect */
        .product-image-wrapper {
            height: 240px;
            overflow: hidden;
            border-bottom: 1px solid #f0f0f0;
            position: relative;
            background: #f8f8f8;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px;
        }

        .product-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            transition: transform 0.4s ease;
        }

        /* Frame main image: clean, no rotation */
        .product-image.main-img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            transition: transform 0.4s ease, opacity 0.4s ease;
            mix-blend-mode: normal;
            filter: none;
            z-index: 1;
            transform: none;
        }

        .product-card:hover .product-image.main-img {
            transform: scale(1.04);
            opacity: 0;
        }

        .product-image.hover-img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0;
            z-index: 3;
            transition: opacity 0.4s ease;
            transform: none !important;
            filter: none !important;
            mix-blend-mode: normal !important;
        }

        .product-card:hover .product-image.hover-img {
            opacity: 1 !important;
        }




        /* Raw Style Overrides for Lenses */
        .product-image.raw-style {
            transform: none !important;
            filter: none !important;
            mix-blend-mode: normal !important;
            width: 100%;
            height: auto;
            max-width: 100%;
            object-fit: contain;
            transition: transform 0.4s ease;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .product-card:hover .product-image.raw-style {
            transform: scale(1.05) !important;
        }

        .product-image-wrapper.raw-wrapper {
            background: #fff;
            padding: 0;
        }

        .product-image-wrapper.raw-wrapper::after {
            display: none;
        }

        .wishlist-icon {
            position: absolute;
            top: 1rem;
            right: 1rem;
            width: 35px;
            height: 35px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: var(--transition);
            z-index: 10;
        }

        .wishlist-icon:hover {
            color: red;
            transform: scale(1.1);
        }

        .product-info {
            padding: 1.5rem;
            text-align: center;
            /* Center align text */
        }

        .product-header {
            display: flex;
            justify-content: center;
            /* Center brand */
            align-items: center;
            margin-bottom: 0.5rem;
            display: none;
            /* Hide top header, move info below name */
        }

        .product-brand {
            font-size: 0.75rem;
            text-transform: uppercase;
            color: var(--text-muted);
            letter-spacing: 1px;
            font-weight: 600;
            display: block;
            margin-bottom: 0.5rem;
        }

        .price-tag {
            font-weight: 700;
            color: #00ac9a;
            /* Teal/Green price color */
            font-size: 1rem;
            display: block;
            margin-top: 0.5rem;
        }

        .product-name {
            font-family: var(--font-heading);
            font-size: 1rem;
            margin-bottom: 0px;
            line-height: 1.4;
            color: #007bff;
            /* Blue title color like reference */
            font-weight: 700;
            text-transform: uppercase;
        }

        .product-meta {
            display: flex;
            justify-content: center;
            /* Center badges */
            gap: 0.5rem;
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-bottom: 1rem;
            flex-wrap: wrap;
            margin-top: 0.5rem;
        }

        .meta-tag {
            background: #f8f9fa;
            padding: 0.2rem 0.6rem;
            border-radius: 4px;
            font-size: 0.7rem;
        }

        /* Results Info */
        .results-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        /* ================================
           MOBILE FIRST RESPONSIVE
           ================================ */

        /* Base (mobile) â€” grid is 2 columns */
        .products-grid {
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
        }

        .product-card {
            border-radius: 12px;
        }

        .product-image-wrapper {
            height: 160px;
            padding: 10px;
        }

        .product-info {
            padding: 0.85rem;
        }

        .product-name {
            font-size: 0.78rem;
        }

        .price-tag {
            font-size: 0.88rem;
        }

        .product-info .btn {
            font-size: 0.72rem;
            padding: 0.55rem 0.8rem;
            margin-top: 0.6rem;
        }

        .page-header {
            padding: 3rem 0 1.5rem;
        }

        .page-header .hero-title {
            font-size: 2.2rem !important;
        }

        .page-header .subtitle {
            font-size: 0.9rem;
        }

        .product-image-wrapper.raw-wrapper {
            background: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Search Bar Styles */
        .search-container {
            margin-bottom: 2rem;
            position: relative;
        }

        .search-input-wrapper {
            position: relative;
            width: 100%;
        }

        .search-input {
            width: 100%;
            padding: 1rem 1rem 1rem 3rem;
            border: 1px solid #eee;
            border-radius: 12px;
            font-family: var(--font-body);
            font-size: 0.95rem;
            transition: var(--transition);
            background: #fcfcfc;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            background: white;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);
        }

        .search-icon {
            position: absolute;
            left: 1.25rem;
            top: 50%;
            transform: translateY(-50%);
            color: #ccc;
            transition: var(--transition);
        }

        .search-input:focus+.search-icon {
            color: var(--primary-dark);
        }

        /* Mobile Filter Tweaks */
        @media (max-width: 992px) {
            .collection-layout {
                display: block;
            }

            .filter-sidebar {
                position: fixed;
                top: 0;
                left: -100%;
                width: min(300px, 85vw);
                height: 100vh;
                background: white;
                z-index: 2000;
                padding: 4rem 2rem 2rem;
                overflow-y: auto;
                transition: left 0.35s ease;
                box-shadow: 10px 0 30px rgba(0, 0, 0, 0.1);
            }

            .filter-sidebar.active {
                left: 0;
            }

            .mobile-filter-toggle {
                display: block;
            }

            .close-filter {
                display: flex;
                align-items: center;
                justify-content: center;
                position: absolute;
                top: 1.5rem;
                right: 1.5rem;
                width: 40px;
                height: 40px;
                background: #f5f5f5;
                border-radius: 50%;
                font-size: 1.2rem;
                cursor: pointer;
                transition: var(--transition);
            }

            .close-filter:hover {
                background: var(--text-main);
                color: white;
            }
        }

        /* Tablet (600px+): 3-column grid */
        @media (min-width: 600px) {
            .products-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 1.25rem;
            }

            .product-image-wrapper {
                height: 200px;
                padding: 12px;
            }

            .product-name {
                font-size: 0.85rem;
            }
        }

        /* Desktop (1024px+): 4-column grid, full sidebar */
        @media (min-width: 1024px) {
            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
                gap: 2rem;
            }

            .product-image-wrapper {
                height: 240px;
                padding: 16px;
            }

            .collection-layout {
                display: grid;
                grid-template-columns: 260px 1fr;
                gap: 3rem;
                align-items: start;
            }

            .mobile-filter-toggle {
                display: none;
            }

            .product-name {
                font-size: 1rem;
            }

            .page-header .hero-title {
                font-size: 4rem !important;
            }
        }
    </style>
</head>


<body>
    <header class="header">
        <div class="container flex align-center justify-between">
            <a href="index.html" class="logo flex align-center">
                <img src="assets/img/lotex_logo.png" alt="Lotex Opticals" style="height: 60px; object-fit: contain;">
            </a>

            <div class="mobile-toggle" id="mobile-toggle">
                <i class="fas fa-bars"></i>
            </div>

            <ul class="nav-links flex align-center">
                <li><a href="index.html">Home</a></li>
                <li><a href="collection.html" class="active" style="color: var(--primary-dark);">Collection</a></li>
                <li><a href="index.html#trending">New Arrivals</a></li>
                <li><a href="index.html#perfect-fit">Our Clinic</a></li>
                <li><a href="index.html#footer">Contact</a></li>
            </ul>
            <div class="header-actions flex align-center">
                <a href="#" class="btn btn-primary btn-sm btn-whatsapp">
                    <i class="fab fa-whatsapp"></i> <span class="btn-text">CLINIC INQUIRY</span>
                </a>
            </div>
            </nav>
    </header>

    <main>
        <!-- HEADER -->
        <section class="page-header">
            <div class="container">
                <span class="label">Curated Selection</span>
                <h1 class="hero-title" style="font-size: 4rem;">The Collection</h1>
                <p class="subtitle" style="max-width: 600px; margin: 0 auto; margin-top: 1rem;">
                    Discover our premium range of frames. From timeless classics to modern statements.
                </p>
            </div>
        </section>

        <!-- COLLECTION LAYOUT -->
        <section class="section-padding" style="padding-top: 0;">
            <div class="container">

                <div class="mobile-filter-toggle" id="filter-toggle">
                    <i class="fas fa-filter"></i> SHOW FILTERS
                </div>

                <div class="collection-layout">
                    <!-- SIDEBAR FILTERS -->
                    <aside class="filter-sidebar" id="filter-sidebar">
                        <div class="close-filter" id="close-filter"><i class="fas fa-times"></i></div>

                        <!-- Search Bar (NEW) -->
                        <div class="search-container">
                            <div class="search-input-wrapper">
                                <input type="text" id="product-search" class="search-input"
                                    placeholder="Search frames, brands...">
                                <i class="fas fa-search search-icon"></i>
                            </div>
                        </div>

                        <!-- Gender -->
                        <div class="filter-group">
                            <div class="filter-title">Gender <i class="fas fa-chevron-down"></i></div>
                            <div class="filter-options">
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="gender" value="Men"> Men
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="gender" value="Women"> Women
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="gender" value="Unisex"> Unisex
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="gender" value="Kids"> Kids
                                </label>
                            </div>
                        </div>

                        <!-- Category (NEW) -->
                        <div class="filter-group">
                            <div class="filter-title">Category <i class="fas fa-chevron-down"></i></div>
                            <div class="filter-options">
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="category" value="Eyeglasses"> Eyeglasses
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="category" value="Sunglasses"> Sunglasses
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="category" value="Computer Glasses"> Computer Glasses
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="category" value="Reading Glasses"> Reading Glasses
                                </label>
                            </div>
                        </div>

                        <!-- Lens Technology (NEW) -->
                        <div class="filter-group">
                            <div class="filter-title">Lens Technology <i class="fas fa-chevron-down"></i></div>
                            <div class="filter-options">
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="lens" value="Progressive Transition"> Progressive
                                    Transition
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="lens" value="Progressive Blue Cut Clear"> Progressive
                                    Blue Cut Clear
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="lens" value="Photo Gray Progressive Blue Cut"> Photo
                                    Gray Progressive Blue Cut
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="lens" value="Bifocal"> Bifocal
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="lens" value="Blue Cut Single Vision"> Blue Cut Single
                                    Vision
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="lens" value="Photo Gray Blue Coating"> Photo Gray Blue
                                    Coating
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="lens" value="Blue Cut Clear"> Blue Cut Clear
                                </label>
                            </div>
                        </div>

                        <!-- Brand -->
                        <div class="filter-group">
                            <div class="filter-title">Brand <i class="fas fa-chevron-down"></i></div>
                            <div class="filter-options" id="brand-filters">
                                <!-- JS will populate -->
                            </div>
                        </div>

                        <!-- Shape -->
                        <div class="filter-group">
                            <div class="filter-title">Shape <i class="fas fa-chevron-down"></i></div>
                            <div class="filter-options">
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="shape" value="Aviator"> Aviator
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="shape" value="Wayfarer"> Wayfarer
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="shape" value="Round"> Round
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="shape" value="Square"> Square
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="shape" value="Cat Eye"> Cat Eye
                                </label>
                            </div>
                        </div>

                        <!-- Price -->
                        <div class="filter-group">
                            <div class="filter-title">Max Price (KES)</div>
                            <div class="price-range-inputs">
                                <input type="number" id="max-price" class="price-input" placeholder="15000"
                                    value="15000">
                                <button class="btn btn-primary btn-sm" id="apply-price">Go</button>
                            </div>
                        </div>

                        <button class="btn btn-outline-white btn-sm" id="clear-filters"
                            style="width: 100%; margin-top: 1rem; border: 1px solid #ddd; color: #333;">Clear All
                            Filters</button>
                    </aside>

                    <!-- PRODUCT GRID -->
                    <div class="collection-content">
                        <div class="results-info">
                            <span id="results-count">Showing 0 results</span>
                            <select
                                style="border: none; background: transparent; font-family: var(--font-body); cursor: pointer;">
                                <option>Sort by: Featured</option>
                                <option>Price: Low to High</option>
                                <option>Price: High to Low</option>
                            </select>
                        </div>
                        <div class="products-grid" id="products-grid">
                            <!-- JS Populates this -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- LENS GUIDE -->
        <section class="lens-guide">
            <div class="container">
                <div class="text-center">
                    <span class="label" style="color: var(--primary);">Premium Options</span>
                    <h2 class="serif section-title" style="color: white; font-size: 3rem;">Lens Technology</h2>
                    <p style="color: #999;">Customize your frames with our advanced lens solutions.</p>
                </div>

                <div class="lens-grid">
                    <div class="lens-card">
                        <i class="fas fa-sun lens-icon"></i>
                        <h3 style="font-size: 1.5rem; margin-bottom: 1rem;">Photochromic</h3>
                        <p style="color: #ccc;">Smart lenses that adapt to changing light. Clear indoors, dark outdoors.
                        </p>
                    </div>
                    <div class="lens-card">
                        <i class="fas fa-laptop-medical lens-icon"></i>
                        <h3 style="font-size: 1.5rem; margin-bottom: 1rem;">Blue Cut</h3>
                        <p style="color: #ccc;">Essential protection against digital eye strain from screens and
                            devices.</p>
                    </div>
                    <div class="lens-card">
                        <i class="fas fa-glasses lens-icon"></i>
                        <h3 style="font-size: 1.5rem; margin-bottom: 1rem;">High Index</h3>
                        <p style="color: #ccc;">Thinner, lighter lenses for superior comfort and aesthetic appeal.</p>
                    </div>
                    <div class="lens-card">
                        <i class="fas fa-ban lens-icon"></i>
                        <h3 style="font-size: 1.5rem; margin-bottom: 1rem;">Anti-Glare</h3>
                        <p style="color: #ccc;">Eliminates reflections for clearer vision and better eye contact.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- FOOTER -->
        <footer class="footer section-padding text-center">
            <div class="container">
                <div class="footer-cta" style="margin-bottom: 3rem;">
                    <a href="#" class="btn btn-primary btn-whatsapp"><i class="fab fa-whatsapp"></i> BOOK
                        APPOINTMENT</a>
                </div>

                <div class="footer-contacts" style="margin-bottom: 2rem; color: #777; font-size: 0.9rem;">
                    <p style="margin-bottom: 0.5rem;"><i class="fas fa-phone-alt"
                            style="margin-right:0.5rem; color: var(--primary);"></i> +254 722 361 831 / +254 736 698 776
                    </p>
                    <p><i class="fas fa-envelope" style="margin-right:0.5rem; color: var(--primary);"></i>
                        mutheewakariuki@gmail.com</p>
                </div>
                <div class="footer-bottom">
                    <p>&copy; 2026 Lotex Opticals & Eye Clinic. Kiambu Town, Kenya.</p>
                </div>
            </div>
        </footer>
    </main>

    <script src="main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // (Mobile Drawer logic moved to bottom of this script block)

            // --- DATA GENERATION ---
            // --- DATA GENERATION ---
            const brands = ['Kala', 'Ox Embery', 'Blue Light Blocking', 'Google', 'Special Cut Eye', 'Eyelid', 'Naili', 'Gabiano', 'Richard Taylor', 'George Piralli', 'Eco', 'Kc Kalla', 'Million', 'Warrior', 'Avam', 'Bright', 'Gallaway'];
            const shapes = ['Round', 'Square', 'Rectangle', 'Cat Eye', 'Aviator', 'Oval'];
            const genders = ['Men', 'Women', 'Unisex', 'Kids'];
            const materials = ['Metal', 'Acetate', 'Titanium', 'Mix', 'Plastic'];
            const categories = ['Eyeglasses', 'Sunglasses', 'Computer Glasses', 'Reading Glasses']; // Weighted for common items
            const lensOptions = []; // Empty: Lens technologies are reserved for standalone products

            const products = [
                {
                    id: 'lens-prog-trans',
                    image: 'assets/lenses/progressive_transition.png',
                    brand: 'Lotex',
                    name: 'Progressive Transition Lens',
                    shape: 'Round',
                    gender: 'Unisex',
                    material: 'Glass',
                    price: 7999,
                    category: 'Eyeglasses',
                    lensFeatures: ['Progressive Transition'],
                    isRaw: true,
                    tags: ['Unisex', 'Round', 'Progressive Transition']
                },
                {
                    id: 'lens-prog-blue-cut',
                    image: 'assets/lenses/progressive_blue_cut_clear.png',
                    brand: 'Lotex',
                    name: 'Progressive Blue Cut Clear',
                    shape: 'Round',
                    gender: 'Unisex',
                    material: 'Glass',
                    price: 8999,
                    category: 'Eyeglasses',
                    lensFeatures: ['Progressive Blue Cut Clear'],
                    isRaw: true,
                    tags: ['Unisex', 'Round', 'Progressive Blue Cut Clear']
                },
                {
                    id: 'lens-photo-gray-prog-blue-cut',
                    image: 'assets/lenses/photo_gray_progressive_blue_cut.png',
                    brand: 'Lotex',
                    name: 'Photo Gray Progressive Blue Cut',
                    shape: 'Round',
                    gender: 'Unisex',
                    material: 'Glass',
                    price: 12000,
                    category: 'Eyeglasses',
                    lensFeatures: ['Photo Gray Progressive Blue Cut'],
                    isRaw: true,
                    tags: ['Unisex', 'Round', 'Photo Gray Progressive Blue Cut']
                },
                {
                    id: 'lens-bifocal',
                    image: 'assets/lenses/bifocal.png',
                    brand: 'Lotex',
                    name: 'Bifocal Lens',
                    shape: 'Round',
                    gender: 'Unisex',
                    material: 'Glass',
                    price: 3999,
                    category: 'Eyeglasses',
                    lensFeatures: ['Bifocal'],
                    isRaw: true,
                    tags: ['Unisex', 'Round', 'Bifocal']
                },
                {
                    id: 'lens-blue-cut-single',
                    image: 'assets/lenses/blue_cut_single_vision.png',
                    brand: 'Lotex',
                    name: 'Blue Cut Single Vision',
                    shape: 'Round',
                    gender: 'Unisex',
                    material: 'Glass',
                    price: 5999,
                    category: 'Eyeglasses',
                    lensFeatures: ['Blue Cut Single Vision'],
                    isRaw: true,
                    tags: ['Unisex', 'Round', 'Blue Cut Single Vision']
                },
                {
                    id: 'lens-photo-gray-blue-coat',
                    image: 'assets/lenses/photo_gray_blue_coating.png',
                    brand: 'Lotex',
                    name: 'Photo Gray Blue Coating',
                    shape: 'Round',
                    gender: 'Unisex',
                    material: 'Glass',
                    price: 2500,
                    category: 'Eyeglasses',
                    lensFeatures: ['Photo Gray Blue Coating'],
                    isRaw: true,
                    tags: ['Unisex', 'Round', 'Photo Gray Blue Coating']
                },
                {
                    id: 'lens-blue-cut-clear',
                    image: 'assets/lenses/blue_cut_clear.png',
                    brand: 'Lotex',
                    name: 'Blue Cut Clear',
                    shape: 'Round',
                    gender: 'Unisex',
                    material: 'Glass',
                    price: 2500,
                    category: 'Eyeglasses',
                    lensFeatures: ['Blue Cut Clear'],
                    isRaw: true,
                    tags: ['Unisex', 'Round', 'Blue Cut Clear']
                },
                // --- Frames (Static List) ---
                { id: 'frame-ox-embery', brand: 'Ox Embery', name: 'Classic Square', price: 6000, image: 'assets/frames/Ox embery.jpg', hoverImage: 'assets/model_images/model_ox_embery.png', category: 'Eyeglasses', gender: 'Unisex', shape: 'Square', material: 'Acetate', isNew: true, rating: 4.8, reviews: 12, lensFeatures: [], tags: ['Unisex', 'Square', 'Eyeglasses', 'Ox Embery'] },
                { id: 'frame-eyelid', brand: 'Eyelid', name: 'Modern Rect', price: 6000, image: 'assets/frames/eyelid.jpg', hoverImage: 'assets/model_images/model_eyelid.png', category: 'Eyeglasses', gender: 'Men', shape: 'Rectangle', material: 'Metal', isNew: false, rating: 4.5, reviews: 8, lensFeatures: [], tags: ['Men', 'Rectangle', 'Eyeglasses', 'Eyelid'] },
                { id: 'frame-gabiano', brand: 'Gabiano', name: 'Elegant Round', price: 5000, image: 'assets/frames/gabiano.jpg', hoverImage: 'assets/model_images/model_gabiano.png', category: 'Eyeglasses', gender: 'Women', shape: 'Round', material: 'Mix', isNew: true, rating: 4.9, reviews: 15, lensFeatures: [], tags: ['Women', 'Round', 'Eyeglasses', 'Gabiano'] },
                { id: 'frame-kc-kalla', brand: 'Kc Kalla', name: 'Urban Style', price: 3000, image: 'assets/frames/kalla.jpg', hoverImage: 'assets/model_images/model_kc_kalla.png', category: 'Eyeglasses', gender: 'Unisex', shape: 'Square', material: 'Acetate', isNew: false, rating: 4.2, reviews: 5, lensFeatures: [], tags: ['Unisex', 'Square', 'Eyeglasses', 'Kc Kalla'] },
                { id: 'frame-million', brand: 'Million', name: 'Luxury Aviator', price: 4000, image: 'assets/frames/million.jpg', hoverImage: 'assets/model_images/model_million.png', category: 'Sunglasses', gender: 'Men', shape: 'Aviator', material: 'Metal', isNew: true, rating: 4.7, reviews: 20, lensFeatures: [], tags: ['Men', 'Aviator', 'Sunglasses', 'Million'] },
                { id: 'frame-danmac', brand: 'Danmac', name: 'Bold Frame', price: 4500, image: 'assets/frames/Danmac.jpg', hoverImage: 'assets/model_images/model_danmac.png', category: 'Eyeglasses', gender: 'Men', shape: 'Square', material: 'Acetate', isNew: false, rating: 4.3, reviews: 6, lensFeatures: [], tags: ['Men', 'Square', 'Eyeglasses', 'Danmac'] },
                { id: 'frame-boivie', brand: 'Boivie', name: 'Slim Profile', price: 5000, image: 'assets/frames/boivie.jpg', hoverImage: 'assets/model_images/model_boivie.png', category: 'Eyeglasses', gender: 'Unisex', shape: 'Rectangle', material: 'Metal', isNew: false, rating: 4.4, reviews: 7, lensFeatures: [], tags: ['Unisex', 'Rectangle', 'Eyeglasses', 'Boivie'] },
                { id: 'frame-caballo', brand: 'Caballo', name: 'Classic Design', price: 4000, image: 'assets/frames/caballo.jpg', hoverImage: 'assets/model_images/model_caballo.png', category: 'Eyeglasses', gender: 'Men', shape: 'Rectangle', material: 'Metal', isNew: false, rating: 4.3, reviews: 5, lensFeatures: [], tags: ['Men', 'Rectangle', 'Eyeglasses', 'Caballo'] },
                { id: 'frame-humphreys', brand: 'Humphreys', name: 'Executive Style', price: 5500, image: 'assets/frames/humphreys.jpg', hoverImage: 'assets/model_images/model_humphreys.png', category: 'Eyeglasses', gender: 'Men', shape: 'Rectangle', material: 'Titanium', isNew: false, rating: 4.6, reviews: 9, lensFeatures: [], tags: ['Men', 'Rectangle', 'Eyeglasses', 'Humphreys'] },
                { id: 'frame-studiomuku', brand: 'Studio Muku', name: 'Artistic Frame', price: 6000, image: 'assets/frames/studiomuku.jpg', hoverImage: 'assets/model_images/model_studiomuku.png', category: 'Eyeglasses', gender: 'Women', shape: 'Round', material: 'Acetate', isNew: true, rating: 4.7, reviews: 11, lensFeatures: [], tags: ['Women', 'Round', 'Eyeglasses', 'Studio Muku'] },
                { id: 'frame-swatch', brand: 'Swatch', name: 'Colorful Pop', price: 3500, image: 'assets/frames/swatch.jpg', category: 'Eyeglasses', gender: 'Unisex', shape: 'Round', material: 'Plastic', isNew: true, rating: 4.5, reviews: 8, lensFeatures: [], tags: ['Unisex', 'Round', 'Eyeglasses', 'Swatch'] },
                { id: 'frame-verona', brand: 'Verona', name: 'Italian Style', price: 7000, image: 'assets/frames/verona.jpg', category: 'Eyeglasses', gender: 'Women', shape: 'Cat Eye', material: 'Acetate', isNew: true, rating: 4.8, reviews: 14, lensFeatures: [], tags: ['Women', 'Cat Eye', 'Eyeglasses', 'Verona'] }


            ];

            const itemsPerPage = 12;

            // --- DOM ELEMENTS ---
            const brandFilterContainer = document.getElementById('brand-filters');
            const grid = document.getElementById('products-grid');
            const resultsCountStr = document.getElementById('results-count');
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            const maxPriceInput = document.getElementById('max-price');
            const applyPriceBtn = document.getElementById('apply-price');
            const clearBtn = document.getElementById('clear-filters');

            // --- FUNCTIONS ---
            function createProductCard(product) {
                const isNewBadge = product.isNew ? '<span class="badge new">New</span>' : '';
                const discount = product.originalPrice ? `<span class="badge discount">-${Math.round((1 - product.price / product.originalPrice) * 100)}%</span>` : '';
                const wrapperClass = product.isRaw ? 'product-image-wrapper raw-wrapper' : 'product-image-wrapper';
                const imgClass = product.isRaw ? 'product-image raw-style' : 'product-image';
                const rotateClass = '';


                // Hover Image Logic - Only for frames, not raw lenses
                let imageHTML = `<img src="${product.image}" alt="${product.name}" class="${imgClass} ${rotateClass} main-img" loading="lazy">`;
                if (!product.isRaw && product.hoverImage) {
                    imageHTML += `<img src="${product.hoverImage}" alt="${product.name} on model" class="${imgClass} hover-img" loading="lazy">`;
                }

                return `
                <div class="product-card reveal-scale" data-id="${product.id}" data-category="${product.category}" data-brand="${product.brand}" data-price="${product.price}">
                    <div class="${wrapperClass}">
                        ${isNewBadge}
                        ${discount}
                        ${imageHTML}
                        <div class="product-actions">
                            <button class="action-btn" title="Add to Wishlist"><i class="far fa-heart"></i></button>
                            <button class="action-btn" title="Quick View"><i class="far fa-eye"></i></button>
                        </div>
                    </div>
                    <div class="product-info">
                        <h3 class="product-name">${product.brand} ${product.name}</h3>
                        <div class="product-meta">
                            <span class="meta-tag" style="background:#eef; color:#33d;">${product.category}</span>
                        </div>
                        <span class="price-tag">KES ${product.price.toLocaleString()}</span> 
                        
                        <a href="#" class="btn btn-outline-white btn-whatsapp" style="width: 100%; margin-top: 1rem; border: 1px solid var(--text-main); color: var(--text-main);">
                            INQUIRE
                        </a>
                    </div>
                </div>
                `;
            }

            function renderProducts(items) {
                if (!grid) return;
                grid.innerHTML = '';
                if (resultsCountStr) resultsCountStr.textContent = `Showing ${items.length} results`;

                if (items.length === 0) {
                    grid.innerHTML = `<div class="text-center" style="grid-column: 1/-1; padding: 4rem; color: #999;">
                        <i class="far fa-frown" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                        <p>No products match your filters.</p>
                        <button onclick="clearFilters()" class="btn btn-primary btn-sm" style="margin-top:1rem;">Clear Filters</button>
                        </div>`;
                    return;
                }

                items.forEach(product => {
                    const cardHTML = createProductCard(product);
                    const tempDiv = document.createElement('div');
                    tempDiv.innerHTML = cardHTML;
                    const card = tempDiv.firstElementChild;
                    grid.appendChild(card);

                    const btn = card.querySelector('.btn-whatsapp');
                    if (btn) {
                        btn.addEventListener('click', (e) => {
                            e.preventDefault();
                            const message = encodeURIComponent(`Hi Lotex! Inquiry about: ${product.brand} ${product.name} for ${product.gender} (Ref: ${product.id}), Price: KES ${product.price}`);
                            window.open(`https://wa.me/254722361831?text=${message}`, '_blank');
                        });
                    }
                });

                // Re-trigger animations
                const revealObserver = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) entry.target.classList.add('active-reveal');
                    });
                });
                document.querySelectorAll('.reveal-scale').forEach(el => revealObserver.observe(el));
            }

            function filterProducts() {
                const searchQuery = document.getElementById('product-search')?.value.toLowerCase() || '';
                const selectedGenders = Array.from(document.querySelectorAll('input[name="gender"]:checked')).map(cb => cb.value);
                const selectedBrands = Array.from(document.querySelectorAll('input[name="brand"]:checked')).map(cb => cb.value);
                const selectedShapes = Array.from(document.querySelectorAll('input[name="shape"]:checked')).map(cb => cb.value);
                const selectedCategories = Array.from(document.querySelectorAll('input[name="category"]:checked')).map(cb => cb.value);
                const selectedLens = Array.from(document.querySelectorAll('input[name="lens"]:checked')).map(cb => cb.value);
                const maxPrice = maxPriceInput ? (parseInt(maxPriceInput.value) || 100000) : 100000;

                const filtered = products.filter(item => {
                    // Lenses (isRaw) bypass most filters to stay visible at the bottom
                    if (item.isRaw) {
                        const searchMatch = !searchQuery || `${item.brand} ${item.name}`.toLowerCase().includes(searchQuery);
                        const priceMatch = item.price <= maxPrice;
                        return searchMatch && priceMatch;
                    }

                    // Search Match for Frames
                    const searchableText = `${item.brand} ${item.name} ${item.category} ${item.gender} ${item.shape}`.toLowerCase();
                    const searchMatch = !searchQuery || searchableText.includes(searchQuery);

                    const categoryMatch = selectedCategories.length === 0 || selectedCategories.includes(item.category);
                    const genderMatch = selectedGenders.length === 0 || selectedGenders.includes(item.gender);
                    const brandMatch = selectedBrands.length === 0 || selectedBrands.includes(item.brand);
                    const shapeMatch = selectedShapes.length === 0 || selectedShapes.includes(item.shape);
                    const lensMatch = selectedLens.length === 0 || selectedLens.some(l => item.lensFeatures.includes(l));
                    const priceMatch = item.price <= maxPrice;

                    return searchMatch && genderMatch && brandMatch && shapeMatch && categoryMatch && lensMatch && priceMatch;
                });

                // Sort: Frames (!isRaw) first, Lenses (isRaw) at the bottom
                const sorted = filtered.sort((a, b) => {
                    if (a.isRaw && !b.isRaw) return 1;
                    if (!a.isRaw && b.isRaw) return -1;
                    return 0;
                });

                renderProducts(sorted);
            }

            // Expose clearFilters globally for the onclick handler in empty state
            window.clearFilters = function () {
                checkboxes.forEach(cb => cb.checked = false);
                if (maxPriceInput) maxPriceInput.value = 15000;
                filterProducts();
            }

            // --- INIT ---
            if (brandFilterContainer) {
                brands.sort().forEach(brand => {
                    const label = document.createElement('label');
                    label.className = 'filter-checkbox';
                    label.innerHTML = `
                        <input type="checkbox" name="brand" value="${brand}"> ${brand}
                    `;
                    brandFilterContainer.appendChild(label);
                });
                // Re-select checkboxes after dynamic addition
                // But specifically for event listeners, querySelectorAll is static? No, creates static NodeList.
                // We need to re-bind or delegate.
                // Since brands are added dynamically, let's delegate or just re-bind to all inputs again?
                // Actually, the original code bound to 'checkboxes' which was queried AFTER dynamic population? 
                // Wait, original code queried BEFORE population? No, let's check.
                // Original code: line 523 dynamic population. line 595 querySelectorAll. So it was AFTER.
                // My new code: querySelectorAll is bound in DOM ELEMENTS section. 
                // So I need to ensure population runs BEFORE querySelectorAll call.
            }

            // Re-query checkboxes after dynamic population if needed
            const allCheckboxes = document.querySelectorAll('input[type="checkbox"]');
            allCheckboxes.forEach(cb => cb.addEventListener('change', filterProducts));

            // Event Listeners for Search & Sidebar
            const searchInput = document.getElementById('product-search');
            if (searchInput) {
                searchInput.addEventListener('input', filterProducts);
            }

            if (applyPriceBtn) applyPriceBtn.addEventListener('click', filterProducts);
            if (maxPriceInput) {
                maxPriceInput.addEventListener('keypress', function (e) {
                    if (e.key === 'Enter') filterProducts();
                });
            }
            if (clearBtn) clearBtn.addEventListener('click', window.clearFilters);

            // Mobile Filter Logic
            const sidebar = document.getElementById('filter-sidebar');
            const toggleBtn = document.getElementById('filter-toggle');
            const closeBtn = document.getElementById('close-filter');

            if (toggleBtn && sidebar) {
                toggleBtn.addEventListener('click', () => {
                    sidebar.classList.add('active');
                });
            }

            if (closeBtn && sidebar) {
                closeBtn.addEventListener('click', () => {
                    sidebar.classList.remove('active');
                });
            }

            // Initial Render (Sorted)
            filterProducts();
        });
    </script>
</body>

</html>