<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Collection | Lotex Opticals</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=Playfair+Display:ital,wght@0,700;1,700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* Collection Specific Styles */
        .page-header {
            padding: 12rem 0 4rem;
            background-color: var(--bg-accent);
            text-align: center;
        }

        /* Layout */
        .collection-layout {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 3rem;
            margin-top: 4rem;
        }

        /* Sidebar Filters */
        .filter-sidebar {
            background: white;
            border-right: 1px solid #f0f0f0;
            padding-right: 2rem;
            height: fit-content;
        }

        .filter-group {
            border-bottom: 1px solid #f0f0f0;
            padding: 1.5rem 0;
        }

        .filter-group:first-child {
            padding-top: 0;
        }

        .filter-title {
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }

        .filter-options {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }

        .filter-checkbox {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-size: 0.9rem;
            color: var(--text-muted);
            cursor: pointer;
            transition: var(--transition);
        }

        .filter-checkbox:hover {
            color: var(--primary-dark);
        }

        .filter-checkbox input {
            accent-color: var(--primary);
            width: 16px;
            height: 16px;
        }

        .price-range-inputs {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .price-input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: var(--font-body);
        }

        /* Mobile Filter Toggle */
        .mobile-filter-toggle {
            display: none;
            background: var(--text-main);
            color: white;
            padding: 1rem 2rem;
            border-radius: 50px;
            width: 100%;
            text-align: center;
            margin-bottom: 2rem;
            cursor: pointer;
            font-weight: 700;
            z-index: 10;
            position: relative;
        }

        /* Products Grid */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 2rem;
            margin-bottom: 6rem;
        }

        .product-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            transition: var(--transition);
            border: 1px solid #f0f0f0;
            position: relative;
        }

        .product-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.08);
        }

        .product-image-wrapper {
            overflow: hidden;
            position: relative;
            background-color: #fff;
            /* Changed to white for cleaner look */
            width: 100%;
            aspect-ratio: 4/3;
            /* Force horizontal aspect ratio */
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .product-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            padding: 1rem;
            /* Reduced padding to make image larger */
            transition: transform 0.6s ease;
            mix-blend-mode: multiply;
            /* Helps blend if white bg */
        }

        .product-card:hover .product-image {
            transform: scale(1.05);
        }

        .wishlist-icon {
            position: absolute;
            top: 1rem;
            right: 1rem;
            width: 35px;
            height: 35px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: var(--transition);
            z-index: 10;
        }

        .wishlist-icon:hover {
            color: red;
            transform: scale(1.1);
        }

        .product-info {
            padding: 1.5rem;
        }

        .product-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .product-brand {
            font-size: 0.75rem;
            text-transform: uppercase;
            color: var(--text-muted);
            letter-spacing: 1px;
            font-weight: 600;
        }

        .price-tag {
            font-weight: 700;
            color: var(--primary-dark);
            font-size: 0.9rem;
        }

        .product-name {
            font-family: var(--font-heading);
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            line-height: 1.2;
        }

        .product-meta {
            display: flex;
            gap: 0.5rem;
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-bottom: 1.2rem;
            flex-wrap: wrap;
        }

        .meta-tag {
            background: var(--bg-accent);
            padding: 0.2rem 0.6rem;
            border-radius: 4px;
        }

        /* Results Info */
        .results-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        /* Responsive */
        @media (max-width: 992px) {
            .collection-layout {
                display: block;
            }

            .filter-sidebar {
                position: fixed;
                top: 0;
                left: -100%;
                width: 300px;
                height: 100vh;
                background: white;
                z-index: 2000;
                padding: 2rem;
                overflow-y: auto;
                transition: var(--transition);
                box-shadow: 10px 0 30px rgba(0, 0, 0, 0.1);
            }

            .filter-sidebar.active {
                left: 0;
            }

            .mobile-filter-toggle {
                display: block;
            }

            .close-filter {
                display: block;
                position: absolute;
                top: 1rem;
                right: 1rem;
                font-size: 1.5rem;
                cursor: pointer;
            }
        }
    </style>
</head>

<body>
    <header class="header">
        <div class="container flex align-center justify-between">
            <a href="index.html" class="logo flex align-center">
                <img src="assets/img/lotex_logo.png" alt="Lotex Opticals" style="height: 60px; object-fit: contain;">
            </a>

            <div class="mobile-toggle" id="mobile-toggle">
                <i class="fas fa-bars"></i>
            </div>

            <ul class="nav-links flex align-center">
                <li><a href="index.html">Home</a></li>
                <li><a href="collection.html" class="active" style="color: var(--primary-dark);">Collection</a></li>
                <li><a href="index.html#trending">New Arrivals</a></li>
                <li><a href="index.html#perfect-fit">Our Clinic</a></li>
                <li><a href="index.html#footer">Contact</a></li>
            </ul>
            <div class="header-actions flex align-center">
                <a href="#" class="btn btn-primary btn-sm btn-whatsapp">
                    <i class="fab fa-whatsapp"></i> <span class="btn-text">CLINIC INQUIRY</span>
                </a>
            </div>
            </nav>
    </header>

    <main>
        <!-- HEADER -->
        <section class="page-header">
            <div class="container">
                <span class="label">Curated Selection</span>
                <h1 class="hero-title" style="font-size: 4rem;">The Collection</h1>
                <p class="subtitle" style="max-width: 600px; margin: 0 auto; margin-top: 1rem;">
                    Discover our premium range of frames. From timeless classics to modern statements.
                </p>
            </div>
        </section>

        <!-- COLLECTION LAYOUT -->
        <section class="section-padding" style="padding-top: 0;">
            <div class="container">

                <div class="mobile-filter-toggle" id="filter-toggle">
                    <i class="fas fa-filter"></i> SHOW FILTERS
                </div>

                <div class="collection-layout">
                    <!-- SIDEBAR FILTERS -->
                    <aside class="filter-sidebar" id="filter-sidebar">
                        <div class="close-filter hide-desktop"><i class="fas fa-times"></i></div>

                        <!-- Gender -->
                        <div class="filter-group">
                            <div class="filter-title">Gender <i class="fas fa-chevron-down"></i></div>
                            <div class="filter-options">
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="gender" value="Men"> Men
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="gender" value="Women"> Women
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="gender" value="Unisex"> Unisex
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="gender" value="Kids"> Kids
                                </label>
                            </div>
                        </div>

                        <!-- Brand -->
                        <div class="filter-group">
                            <div class="filter-title">Brand <i class="fas fa-chevron-down"></i></div>
                            <div class="filter-options" id="brand-filters">
                                <!-- JS will populate -->
                            </div>
                        </div>

                        <!-- Shape -->
                        <div class="filter-group">
                            <div class="filter-title">Shape <i class="fas fa-chevron-down"></i></div>
                            <div class="filter-options">
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="shape" value="Aviator"> Aviator
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="shape" value="Wayfarer"> Wayfarer
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="shape" value="Round"> Round
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="shape" value="Square"> Square
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="shape" value="Cat Eye"> Cat Eye
                                </label>
                            </div>
                        </div>

                        <!-- Price -->
                        <div class="filter-group">
                            <div class="filter-title">Max Price (KES)</div>
                            <div class="price-range-inputs">
                                <input type="number" id="max-price" class="price-input" placeholder="15000"
                                    value="15000">
                                <button class="btn btn-primary btn-sm" id="apply-price">Go</button>
                            </div>
                        </div>

                        <button class="btn btn-outline-white btn-sm" id="clear-filters"
                            style="width: 100%; margin-top: 1rem; border: 1px solid #ddd; color: #333;">Clear All
                            Filters</button>
                    </aside>

                    <!-- PRODUCT GRID -->
                    <div class="collection-content">
                        <div class="results-info">
                            <span id="results-count">Showing 0 results</span>
                            <select
                                style="border: none; background: transparent; font-family: var(--font-body); cursor: pointer;">
                                <option>Sort by: Featured</option>
                                <option>Price: Low to High</option>
                                <option>Price: High to Low</option>
                            </select>
                        </div>
                        <div class="products-grid" id="products-grid">
                            <!-- JS Populates this -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- LENS GUIDE -->
        <section class="lens-guide">
            <div class="container">
                <div class="text-center">
                    <span class="label" style="color: var(--primary);">Premium Options</span>
                    <h2 class="serif section-title" style="color: white; font-size: 3rem;">Lens Technology</h2>
                    <p style="color: #999;">Customize your frames with our advanced lens solutions.</p>
                </div>

                <div class="lens-grid">
                    <div class="lens-card">
                        <i class="fas fa-sun lens-icon"></i>
                        <h3 style="font-size: 1.5rem; margin-bottom: 1rem;">Photochromic</h3>
                        <p style="color: #ccc;">Smart lenses that adapt to changing light. Clear indoors, dark outdoors.
                        </p>
                    </div>
                    <div class="lens-card">
                        <i class="fas fa-laptop-medical lens-icon"></i>
                        <h3 style="font-size: 1.5rem; margin-bottom: 1rem;">Blue Cut</h3>
                        <p style="color: #ccc;">Essential protection against digital eye strain from screens and
                            devices.</p>
                    </div>
                    <div class="lens-card">
                        <i class="fas fa-glasses lens-icon"></i>
                        <h3 style="font-size: 1.5rem; margin-bottom: 1rem;">High Index</h3>
                        <p style="color: #ccc;">Thinner, lighter lenses for superior comfort and aesthetic appeal.</p>
                    </div>
                    <div class="lens-card">
                        <i class="fas fa-ban lens-icon"></i>
                        <h3 style="font-size: 1.5rem; margin-bottom: 1rem;">Anti-Glare</h3>
                        <p style="color: #ccc;">Eliminates reflections for clearer vision and better eye contact.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- FOOTER -->
        <footer class="footer section-padding text-center">
            <div class="container">
                <div class="footer-cta" style="margin-bottom: 3rem;">
                    <a href="#" class="btn btn-primary btn-whatsapp"><i class="fab fa-whatsapp"></i> BOOK
                        APPOINTMENT</a>
                </div>

                <div class="footer-contacts" style="margin-bottom: 2rem; color: #777; font-size: 0.9rem;">
                    <p style="margin-bottom: 0.5rem;"><i class="fas fa-phone-alt"
                            style="margin-right:0.5rem; color: var(--primary);"></i> +254 722 361 831 / +254 736 698 776
                    </p>
                    <p><i class="fas fa-envelope" style="margin-right:0.5rem; color: var(--primary);"></i>
                        mutheewakariuki@gmail.com</p>
                </div>
                <div class="footer-bottom">
                    <p>&copy; 2026 Lotex Opticals & Eye Clinic. Kiambu Town, Kenya.</p>
                </div>
            </div>
        </footer>
    </main>

    <script src="main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- MOBILE DRAWER TOGGLE (Priority) ---
            const filterToggle = document.getElementById('filter-toggle');
            const sidebar = document.getElementById('filter-sidebar');
            const closeFilter = document.querySelector('.close-filter');

            if (filterToggle && sidebar) {
                filterToggle.addEventListener('click', () => {
                    sidebar.classList.add('active');
                });
            }

            if (closeFilter && sidebar) {
                closeFilter.addEventListener('click', () => {
                    sidebar.classList.remove('active');
                });
            }

            // --- DATA GENERATION ---
            const brands = ['Kalla', 'Gabiano', 'RayBan', 'Gucci', 'Prada', 'Tom Ford', 'Versace', 'Dior', 'Oakley', 'Carrera'];
            const shapes = ['Aviator', 'Wayfarer', 'Round', 'Square', 'Cat Eye', 'Oval', 'Geometric'];
            const genders = ['Men', 'Women', 'Unisex', 'Kids'];
            const materials = ['Metal', 'Acetate', 'Titanium', 'Mix'];

            const products = [];
            const imageFiles = [
                "photo_10_2026-02-11_07-35-07.jpg", "photo_11_2026-02-11_07-35-07.jpg", "photo_12_2026-02-11_07-35-07.jpg",
                "photo_13_2026-02-11_07-35-07.jpg", "photo_14_2026-02-11_07-35-07.jpg", "photo_15_2026-02-11_07-35-07.jpg",
                "photo_16_2026-02-11_07-35-07.jpg", "photo_17_2026-02-11_07-35-07.jpg", "photo_18_2026-02-11_07-35-07.jpg",
                "photo_19_2026-02-11_07-35-07.jpg", "photo_20_2026-02-11_07-35-07.jpg", "photo_21_2026-02-11_07-35-07.jpg",
                "photo_22_2026-02-11_07-35-07.jpg", "photo_23_2026-02-11_07-35-07.jpg", "photo_24_2026-02-11_07-35-07.jpg",
                "photo_25_2026-02-11_07-35-07.jpg", "photo_26_2026-02-11_07-35-07.jpg", "photo_27_2026-02-11_07-35-07.jpg",
                "photo_28_2026-02-11_07-35-07.jpg", "photo_29_2026-02-11_07-35-07.jpg", "photo_30_2026-02-11_07-35-07.jpg",
                "photo_31_2026-02-11_07-35-07.jpg", "photo_32_2026-02-11_07-35-07.jpg", "photo_33_2026-02-11_07-35-07.jpg",
                "photo_34_2026-02-11_07-35-07.jpg", "photo_35_2026-02-11_07-35-07.jpg", "photo_36_2026-02-11_07-35-07.jpg",
                "photo_37_2026-02-11_07-35-07.jpg", "photo_38_2026-02-11_07-35-07.jpg", "photo_39_2026-02-11_07-35-07.jpg",
                "photo_40_2026-02-11_07-35-07.jpg", "photo_41_2026-02-11_07-35-07.jpg", "photo_42_2026-02-11_07-35-07.jpg",
                "photo_5_2026-02-11_07-35-07.jpg", "photo_6_2026-02-11_07-35-07.jpg", "photo_7_2026-02-11_07-35-07.jpg",
                "photo_8_2026-02-11_07-35-07.jpg", "photo_9_2026-02-11_07-35-07.jpg"
            ];

            const getRandom = (arr) => arr[Math.floor(Math.random() * arr.length)];
            const getRandomPrice = (min, max) => Math.floor(Math.random() * (max - min + 1) / 100) * 100 + min;

            // Populate Products
            imageFiles.forEach((file, index) => {
                const brand = getRandom(brands);
                const shape = getRandom(shapes);
                const gender = getRandom(genders);
                const material = getRandom(materials);
                const price = getRandomPrice(2500, 12000);

                products.push({
                    id: index,
                    image: `assets/frames/${file}`,
                    brand: brand,
                    name: `${shape} ${material}`,
                    shape: shape,
                    gender: gender,
                    material: material,
                    price: price,
                    tags: [gender, shape]
                });
            });

            // --- DOM ELEMENTS ---
            const brandFilterContainer = document.getElementById('brand-filters');
            const grid = document.getElementById('products-grid');
            const resultsCountStr = document.getElementById('results-count');
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            const maxPriceInput = document.getElementById('max-price');
            const applyPriceBtn = document.getElementById('apply-price');
            const clearBtn = document.getElementById('clear-filters');

            // --- FUNCTIONS ---
            function renderProducts(items) {
                if (!grid) return;
                grid.innerHTML = '';
                if (resultsCountStr) resultsCountStr.textContent = `Showing ${items.length} results`;

                if (items.length === 0) {
                    grid.innerHTML = `<div class="text-center" style="grid-column: 1/-1; padding: 4rem; color: #999;">
                        <i class="far fa-frown" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                        <p>No products match your filters.</p>
                        <button onclick="clearFilters()" class="btn btn-primary btn-sm" style="margin-top:1rem;">Clear Filters</button>
                        </div>`;
                    return;
                }

                items.forEach(product => {
                    const card = document.createElement('div');
                    card.className = 'product-card reveal-scale';
                    card.innerHTML = `
                        <div class="product-image-wrapper">
                             <div class="wishlist-icon"><i class="far fa-heart"></i></div>
                            <img src="${product.image}" alt="${product.name}" class="product-image" loading="lazy">
                        </div>
                        <div class="product-info">
                            <div class="product-header">
                                 <span class="product-brand">${product.brand}</span>
                                 <span class="price-tag">KES ${product.price.toLocaleString()}</span> 
                            </div>
                            <h3 class="product-name">${product.gender}'s ${product.name}</h3>
                            <div class="product-meta">
                                ${product.tags.map(tag => `<span class="meta-tag">${tag}</span>`).join('')}
                            </div>
                            <a href="#" class="btn btn-outline-white btn-whatsapp" style="width: 100%; border: 1px solid var(--text-main); color: var(--text-main);">
                                INQUIRE
                            </a>
                        </div>
                    `;
                    grid.appendChild(card);

                    const btn = card.querySelector('.btn-whatsapp');
                    if (btn) {
                        btn.addEventListener('click', (e) => {
                            e.preventDefault();
                            const message = encodeURIComponent(`Hi Lotex! Inquiry about: ${product.brand} ${product.name} for ${product.gender} (Ref: ${product.id}), Price: KES ${product.price}`);
                            window.open(`https://wa.me/254722361831?text=${message}`, '_blank');
                        });
                    }
                });

                // Re-trigger animations
                const revealObserver = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) entry.target.classList.add('active-reveal');
                    });
                });
                document.querySelectorAll('.reveal-scale').forEach(el => revealObserver.observe(el));
            }

            function filterProducts() {
                const selectedGenders = Array.from(document.querySelectorAll('input[name="gender"]:checked')).map(cb => cb.value);
                const selectedBrands = Array.from(document.querySelectorAll('input[name="brand"]:checked')).map(cb => cb.value);
                const selectedShapes = Array.from(document.querySelectorAll('input[name="shape"]:checked')).map(cb => cb.value);
                const maxPrice = maxPriceInput ? (parseInt(maxPriceInput.value) || 100000) : 100000;

                const filtered = products.filter(item => {
                    const genderMatch = selectedGenders.length === 0 || selectedGenders.includes(item.gender);
                    const brandMatch = selectedBrands.length === 0 || selectedBrands.includes(item.brand);
                    const shapeMatch = selectedShapes.length === 0 || selectedShapes.includes(item.shape);
                    const priceMatch = item.price <= maxPrice;

                    return genderMatch && brandMatch && shapeMatch && priceMatch;
                });

                renderProducts(filtered);
            }

            // Expose clearFilters globally for the onclick handler in empty state
            window.clearFilters = function () {
                checkboxes.forEach(cb => cb.checked = false);
                if (maxPriceInput) maxPriceInput.value = 15000;
                filterProducts();
            }

            // --- INIT ---
            if (brandFilterContainer) {
                brands.sort().forEach(brand => {
                    const label = document.createElement('label');
                    label.className = 'filter-checkbox';
                    label.innerHTML = `
                        <input type="checkbox" name="brand" value="${brand}"> ${brand}
                    `;
                    brandFilterContainer.appendChild(label);
                });
                // Re-select checkboxes after dynamic addition
                // But specifically for event listeners, querySelectorAll is static? No, creates static NodeList.
                // We need to re-bind or delegate.
                // Since brands are added dynamically, let's delegate or just re-bind to all inputs again?
                // Actually, the original code bound to 'checkboxes' which was queried AFTER dynamic population? 
                // Wait, original code queried BEFORE population? No, let's check.
                // Original code: line 523 dynamic population. line 595 querySelectorAll. So it was AFTER.
                // My new code: querySelectorAll is bound in DOM ELEMENTS section. 
                // So I need to ensure population runs BEFORE querySelectorAll call.
            }

            // Re-query checkboxes after dynamic population if needed
            const allCheckboxes = document.querySelectorAll('input[type="checkbox"]');
            allCheckboxes.forEach(cb => cb.addEventListener('change', filterProducts));

            if (applyPriceBtn) applyPriceBtn.addEventListener('click', filterProducts);
            if (maxPriceInput) {
                maxPriceInput.addEventListener('keypress', function (e) {
                    if (e.key === 'Enter') filterProducts();
                });
            }
            if (clearBtn) clearBtn.addEventListener('click', window.clearFilters);

            // Initial Render
            renderProducts(products);
        });
    </script>
</body>

</html>